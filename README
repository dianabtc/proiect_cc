# Create cluster:
minikube start
alias kubectl="minikube kubectl --"
echo 'alias kubectl="minikube kubectl --"' >> ~/.bashrc
source ~/.bashrc
kubectl get nodes
# Enable ingress in cluster
minikube addons enable ingress

# Enter/Exit Minikube's Docker environment
eval $(minikube docker-env)
eval $(minikube docker-env -u)

# Build Auth Service Docker Image
cd auth-service
eval $(minikube docker-env)
docker build -t auth-service:latest .

# Build Reservation Service Docker Image
cd reservaion-service
eval $(minikube docker-env)
docker build -t reservation-service:latest .

# Install/Upgrade using Helm
cd ../proiect_cc
helm install booking ./helm/booking-platform
helm upgrade booking ./helm/booking-platform
kubectl get pods
kubectl get svc
kubectl get pvc

# Access Auth Service and Reservation Service (with Ingress)
minikube tunnel
in browser -> localhost/auth/docs and localhost/reservation/docs

# Access Adminer
minikube service adminer
server: mysql
user: root
password: password


## Restart deployment:
kubectl rollout restart deployment auth-service
kubectl rollout restart deployment reservation-service



