# Create cluster:
minikube start
alias kubectl="minikube kubectl --"
echo 'alias kubectl="minikube kubectl --"' >> ~/.bashrc
source ~/.bashrc
kubectl get nodes

# Enter/Exit Minikube's Docker environment
eval $(minikube docker-env)
eval $(minikube docker-env -u)

# Build Auth Service Docker Image
cd auth-service
eval $(minikube docker-env)
docker build -t auth-service:latest .

# Build Reservation Service Docker Image
cd reservaion-service
eval $(minikube docker-env)
docker build -t reservation-service:latest .

# Install/Upgrade using Helm
cd ../proiect_cc
helm install booking ./helm/booking-platform
helm upgrade booking ./helm/booking-platform
kubectl get pods
kubectl get svc
kubectl get pvc

# Access Auth Service
kubectl port-forward service/auth-service 8000:8000 -> localhost:8000/docs
kubectl port-forward service/reservation-service 8001:8000 -> localhost:8001/docs

# Access Adminer
minikube service adminer
server: mysql
user: root
password: password


## Restart deployment:
kubectl rollout restart deployment auth-service
kubectl rollout restart deployment reservation-service



